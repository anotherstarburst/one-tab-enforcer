{"version":3,"file":"index.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,iBAAkB,GAAIH,GACH,iBAAZC,QACdA,QAAwB,eAAID,IAE5BD,EAAqB,eAAIC,GAC1B,CATD,CASGK,MAAM,I,gDCPTC,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IAsEtDP,EAAA,QAhDA,SAAqBQ,EAAIC,GACrB,IA6BQC,EA7BJC,EAAKH,EAAGI,MAAOA,OAAe,IAAPD,EAAgB,mBAAqBA,EAAIE,EAAKL,EAAGM,QAASA,OAAiB,IAAPD,EAAgB,GAAKA,EAAIE,EAAKP,EAAGQ,qBAAsBA,OAA8B,IAAPD,EAAgB,GAAKA,EAAIE,EAAKT,EAAGU,cAAeA,OAAuB,IAAPD,EAAgB,GAAKA,EAE9PE,EAAgB,MA2BZT,EAAK,IAAIU,iBAAiBR,IAC3BS,UAAY,SAAUC,GAErB,GAAmB,SAAfA,EAAMC,KAIN,OAHAJ,GAAgB,EA9ChC,SAAqBD,EAAeF,GAEhC,IAAIQ,EAASN,GAXG,gNAYhB,GAAIF,EACYS,SAASC,cAAcV,GAC7BW,UAAYH,MAFtB,CAKA,IAAII,EAAMH,SAASI,cAAc,OACjCD,EAAID,UAAYH,EAChBC,SAASK,KAAKC,QAAQH,EAHtB,CAIJ,CAoCgBI,CAAYd,EAAeF,QAC3BN,EAAGuB,QAGPvB,EAAGwB,YAAY,OACnB,EACAxB,EAAGwB,YAAY,QACfC,YAAW,WA7BW,OAAlBhB,IAMJA,GAAgB,EACTV,IAwBP,GAAGK,EAGX,C","sources":["webpack://OneTabEnforcer/webpack/universalModuleDefinition","webpack://OneTabEnforcer/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OneTabEnforcer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OneTabEnforcer\"] = factory();\n\telse\n\t\troot[\"OneTabEnforcer\"] = factory();\n})(this, () => {\nreturn ","\"use strict\";\n/* eslint-disable no-console */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar defaultMarkup = \"\\n  <div style=\\\" display: flex;justify-content: center;flex-direction: column;height: 100vh; text-align: center;\\\" >\\n    <h1>\\n      \\u26A0\\uFE0F This is a duplicate tab - please shut it down.\\n    </h1>\\n  </div>\\n\";\n/**\n * Description.\n * This sends a warning to the DOM.\n *\n * @param {String} warningMarkup Markup for the warning. This will be put in an element's innerHTML.\n * @param {String} warningQuerySelector The query selector that we'll put the warning markup into.\n * @returns {void}\n */\nfunction showWarning(warningMarkup, warningQuerySelector) {\n    console.warn('theEnforcer>showWarning: Close this tab down, it is a duplicate');\n    var markup = warningMarkup || defaultMarkup;\n    if (warningQuerySelector) {\n        var elm_1 = document.querySelector(warningQuerySelector);\n        elm_1.innerHTML = markup;\n        return;\n    }\n    var elm = document.createElement('div');\n    elm.innerHTML = markup;\n    document.body.prepend(elm);\n}\nfunction theEnforcer(_a, functionToRun) {\n    var _b = _a.appID, appID = _b === void 0 ? 'some-unique-name' : _b, _c = _a.timeout, timeout = _c === void 0 ? 50 : _c, _d = _a.warningQuerySelector, warningQuerySelector = _d === void 0 ? '' : _d, _e = _a.warningMarkup, warningMarkup = _e === void 0 ? '' : _e;\n    console.debug('theEnforcer');\n    var siblingsFound = null;\n    /**\n     * Description.\n     * Checks to see if siblings have been found and if not it'll execute the `functionToRun()`.\n     * Note, that this function should only run once.\n     *\n     * @returns {(boolean|Function)}\n     */\n    function checkNoSiblings() {\n        console.debug('theEnforcer>checkNoSiblings');\n        if (siblingsFound !== null) {\n            console.debug('theEnforcer>checkNoSiblings: siblingsFound !== null');\n            // either this function has run already (`siblingsFound === false `)or siblings\n            // have been found (`siblingsFound = true`)\n            return false;\n        }\n        siblingsFound = false;\n        return functionToRun();\n    }\n    /**\n     * Description.\n     * Kicks off a search for sibling tabs that are listening on the same BroadcastChannel.\n     * If found within the `timeout` wait time, it'll shut down the BroadcastChannel listener and\n     * show the warning markup.\n     */\n    function searchForSibling() {\n        console.debug('theEnforcer>searchForSibling');\n        var bc = new BroadcastChannel(appID);\n        bc.onmessage = function (event) {\n            console.debug('theEnforcer>searchForSibling>bc.onmessage', event);\n            if (event.data === 'pong') {\n                siblingsFound = true;\n                showWarning(warningMarkup, warningQuerySelector);\n                bc.close();\n                return;\n            }\n            bc.postMessage('pong');\n        };\n        bc.postMessage('ping');\n        setTimeout(function () {\n            checkNoSiblings();\n        }, timeout);\n    }\n    searchForSibling();\n}\nexports.default = theEnforcer;\n"],"names":["root","factory","exports","module","define","amd","this","Object","defineProperty","value","_a","functionToRun","bc","_b","appID","_c","timeout","_d","warningQuerySelector","_e","warningMarkup","siblingsFound","BroadcastChannel","onmessage","event","data","markup","document","querySelector","innerHTML","elm","createElement","body","prepend","showWarning","close","postMessage","setTimeout"],"sourceRoot":""}