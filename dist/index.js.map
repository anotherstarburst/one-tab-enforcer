{"version":3,"file":"index.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,iBAAkB,GAAIH,GACH,iBAAZC,QACdA,QAAwB,eAAID,IAE5BD,EAAqB,eAAIC,GAC1B,CATD,CASGK,MAAM,I,gDCRTC,OAAOC,eAAeN,EAAS,aAAc,CAAEO,OAAO,IAItD,IAAIC,EAAuB,kNAsE3BR,EAAA,QAvCA,SAA8BS,EAASC,QACnB,IAAZD,IAAsBA,EAAU,CAAC,GACrC,IAqBQE,EArBJC,EAAKH,EAAQI,MAAOA,OAAe,IAAPD,EAAgB,mBAAqBA,EAAIE,EAAKL,EAAQM,QAASA,OAAiB,IAAPD,EAAgB,GAAKA,EAAIE,EAAKP,EAAQQ,qBAAsBA,OAA8B,IAAPD,EAAgB,GAAKA,EAAIE,EAAKT,EAAQU,cAAeA,OAAuB,IAAPD,EAAgB,GAAKA,EAClRE,EAAuB,KAM3B,SAASC,IACL,OAA6B,OAAzBD,IAIJA,GAAuB,EACvBV,KACO,EACX,EAMQC,EAAK,IAAIW,iBAAiBT,IAC3BU,UAAY,SAAUC,GACF,SAAfA,EAAMC,MACNL,GAAuB,EAjDvC,SAAwBM,EAAQC,GAC5B,IACIC,EADAC,EAAkBH,GAAUlB,EAEhC,GAAImB,GAEA,KADAC,EAAgBE,SAASH,cAAcA,IAGnC,YAIJC,EAAgBE,SAASC,cAAc,OACvCD,SAASE,KAAKC,QAAQL,GAE1BA,EAAcM,UAAYL,CAC9B,CAmCgBM,CAAehB,EAAeF,GAC9BN,EAAGyB,SAGHzB,EAAG0B,YAAY,OAEvB,EACA1B,EAAG0B,YAAY,QACfC,WAAWjB,EAAiBN,EAGpC,C","sources":["webpack://OneTabEnforcer/webpack/universalModuleDefinition","webpack://OneTabEnforcer/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OneTabEnforcer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OneTabEnforcer\"] = factory();\n\telse\n\t\troot[\"OneTabEnforcer\"] = factory();\n})(this, () => {\nreturn ","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * The default HTML markup to display when a duplicate tab is detected.\n */\nvar defaultWarningMarkup = \"\\n  <div style=\\\"display: flex; justify-content: center; flex-direction: column; height: 100vh; text-align: center;\\\" >\\n    <h1>\\n      \\u26A0\\uFE0F This is a duplicate tab - please shut it down.\\n    </h1>\\n  </div>\\n\";\n/**\n * Display a warning message in the console and on the DOM.\n *\n * @param {String} markup Markup for the warning. This will be put in an element's innerHTML.\n * @param {String} querySelector The query selector that we'll put the warning markup into.\n * @returns {void}\n */\nfunction displayWarning(markup, querySelector) {\n    var effectiveMarkup = markup || defaultWarningMarkup;\n    var targetElement;\n    if (querySelector) {\n        targetElement = document.querySelector(querySelector);\n        if (!targetElement) {\n            console.warn(\"No element matches the provided query selector \\\"\".concat(querySelector, \"\\\".\"));\n            return;\n        }\n    }\n    else {\n        targetElement = document.createElement('div');\n        document.body.prepend(targetElement);\n    }\n    targetElement.innerHTML = effectiveMarkup;\n}\n/**\n * Ensure that the provided function runs only once in a unique tab.\n *\n * @param {EnforcerOptions} options Configuration options.\n * @param {Function} functionToRun The function to run when no duplicate tab is detected.\n */\n// eslint-disable-next-line @typescript-eslint/default-param-last\nfunction DuplicateTabEnforcer(options, functionToRun) {\n    if (options === void 0) { options = {}; }\n    var _a = options.appID, appID = _a === void 0 ? 'some-unique-name' : _a, _b = options.timeout, timeout = _b === void 0 ? 50 : _b, _c = options.warningQuerySelector, warningQuerySelector = _c === void 0 ? '' : _c, _d = options.warningMarkup, warningMarkup = _d === void 0 ? '' : _d;\n    var duplicateTabDetected = null;\n    /**\n     * Execute the provided function if no duplicate tab is detected.\n     *\n     * @returns {boolean}\n     */\n    function executeIfUnique() {\n        if (duplicateTabDetected !== null) {\n            console.warn('Duplicate tab detected or function has already been executed. Function will not be executed.');\n            return false;\n        }\n        duplicateTabDetected = false;\n        functionToRun();\n        return true;\n    }\n    /**\n     * Start a search for duplicate tabs.\n     * If a duplicate tab is found within the specified timeout, show a warning and stop the function execution.\n     */\n    function initiateTabSearch() {\n        var bc = new BroadcastChannel(appID);\n        bc.onmessage = function (event) {\n            if (event.data === 'pong') {\n                duplicateTabDetected = true;\n                displayWarning(warningMarkup, warningQuerySelector);\n                bc.close();\n            }\n            else {\n                bc.postMessage('pong');\n            }\n        };\n        bc.postMessage('ping');\n        setTimeout(executeIfUnique, timeout);\n    }\n    initiateTabSearch();\n}\nexports.default = DuplicateTabEnforcer;\n"],"names":["root","factory","exports","module","define","amd","this","Object","defineProperty","value","defaultWarningMarkup","options","functionToRun","bc","_a","appID","_b","timeout","_c","warningQuerySelector","_d","warningMarkup","duplicateTabDetected","executeIfUnique","BroadcastChannel","onmessage","event","data","markup","querySelector","targetElement","effectiveMarkup","document","createElement","body","prepend","innerHTML","displayWarning","close","postMessage","setTimeout"],"sourceRoot":""}